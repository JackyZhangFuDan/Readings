# 12 Factor App
这是在做微服务时经常被提及的一套原则，提出者具有很多Cloud上微服务的开发经验 - 主要在Heroku平台上的应用开发，所以非常有参考价值。我在读完这12条原则后，感觉还是非常认同的，特别是对于刚起步做微服务的团队来说非常有指导意义。


[代码库 - Codebase](https://12factor.net/codebase)
---
保持App和代码库是1：1关系。这里“代码库”可以理解为Git里面的一个Repository。  
一份代码，多处部署。  并不是说多个部署跑的版本都是一样的，完全可以例如D上跑最新的代码；Q上跑在测试的次新的代码；P上跑比较老但是很稳定的代码

[关于依赖 - 显示声明出来](https://12factor.net/zh_cn/dependencies)
---
简单来说，我们的程序不要偷偷去依赖一些东西，哪怕它一定存在于绝大多数操作系统层面，要把这种依赖声明出来。我觉得这种说法也是非常合理的，缺包造成的问题往往是很头疼的。这增强了应用的普遍可用性。

[关于配置 - 用环境变量存](https://12factor.net/zh_cn/config)
---
把我们的程序中使用的配置信息通过环境变量来存，而不是具体的文件。优点是：  
1. 灵活，在不同环境上需要不同的配置？简单啊，只要改环境变量就好了，代码一点儿不动   
2. 保密，很多配置都是不能公开的，你放在代码库里面那很多人就看到了  
想想很多Spring的application.properites里面的内容是可以移到环境变量的，这并不是说.properties文件应该没有，技术性的信息还是要配在里面例如DB Driver用什么，这些东西不私密，不会随环境变化而变化

[服务 - 保持它们可替换](https://12factor.net/zh_cn/backing-services)
---
我们力求把“服务”变得非常容易替换，例如数据库服务，邮箱服务等等，只要有必要我们就可以去替换它们。不仅仅是我们通过‘拿来主义’复用的第三方服务，在我们自己的服务时候也要保持这种原则。  
我感觉作者还对替换的过程提出要求，不用改代码，只要系统管理员操作一下就可以完成，那将是最理想的。  
其实这是我们做微服务的一条重要原则，独立性，可替换性，非常重要

[构建 - 发布 - 运行，严格区分](https://12factor.net/build-release-run)
---
我们要在项目中严格划分出这三个阶段，定义好它们的内容和动作。作者对三者做如下定义：  
1. 构建：就是程序打包的过程
2. 发布：就是把打包好的程序结合它们的配置，组织好存放在某些地方，等待上线的指令，一旦指令到来，立刻就可以启动运行的过程。每一个发布都要有唯一的版本号加以区别，从而线上程序能够在版本之间切换。
3. 运行：启动一个版本，从失败中回复一个版本的运行等等。作者认为这个过程应该尽量自动化，不然线上程序半夜死掉没有人能及时发现并补救，但我想肯定不能完全自动化，例如线上版本的选择可定是人来做。

[要用无状态进程](https://12factor.net/processes)
---
我们的程序肯定是在一个或者多个进程中运行的，我们在做程序的时候要假设所有请求都是无状态的，一个请求不应该依赖于进程里前面请求形成的缓存数据，状态数据等，除非是前面请求明确的持久化了的数据。  
针对这一条要求我只能从复杂度的角度理解，它会让我们的程序比较的简单，服务器负担上可以减轻因为毕竟不用关心session数据的保持了，健壮性会好一点儿？但这个要求对开发理念冲击还是挺大的，特别是只做过之前tomcat上jsp类网站开发的程序员

[端口绑定 - 只需要做完这个就可以享受服务](https://12factor.net/zh_cn/port-binding)
---
作者提出如下要求：  
1. 我们的应用应该需要环境提供服务器，自己就应该内嵌服务器；  
2. 我们的应用可以被管理员绑定到其所在环境的某个端口上，然后就可以开始提供服务了。作者认为几乎所有的服务端程序都可以通过端口绑定的方式对外提供服务。
我觉得第一点要求还是过于绝对了，在sprint boot中是有内嵌服务器的，但其版本我们不可控，我很担心在一些情况下这种内嵌服务器的方式不可以接手。但总的来说我理解作者想达到的目的：从外部来看，一个 12 factor app是一个非常干净，省心的应用，你要做的就是启动它，把它绑到一个端口上，that is！剩下的app自己都包了，高度内聚，连server都自己提供了可见和环境耦合性是多么低！